1、按照epel源
```
yum install epel-release -y 
```

2、谷歌pm的认证插件（linux身份验证模块）
```
yum install -y google-authenticator
```

3、使用centos普通用户
```
$ google-authenticator

Do you want authentication tookens to be time-based(y/n) y  #是否基于时间的认证
Warning: posting the following URL into you browser exposes the OPT secret to Google:
  httos://www.google.com/chart?chs=200x2008chld-M10&cht=qr&cht-qr&chl=otpauth://totp/centos@findsec%3Fsecret%3D3WRNF3EMNYWK3GpOQMFIMYN25M%26issuer%findsec


Your new secret key is 
Your verification code is 740200
Your emergency scratch codes are:
  95161540
  43065439
  56598756
  22913373
  15868163
  
Do you want me to update you "/home/centos/.google_authenticator" file?(y/n) y

DO you want to disallow multiple uses of the same authentication
token? This restricts you to one login about every 30s. but it increases
your chances to notice or even prevent mon-in-the-middle attacks(y/n) y


Do you want to do so?(y/n) n


Do you want to enable rate-limiting?(y/n)y
```

4、修改pam模块文件
```
sudo vim /etc/pam.d/sshd
#末尾添加安装的google模块
auth required pam_google_authenticator.so
```

5、配置ssh支持
```
sodo vim /etc/ssh/sshd_config
#ChallengeResponseAuthentication no 将no改成也是
ChallengeResponseAuthentication yes

#重启服务
sudo systemctl restart sshd
```

6、可以在新的终端进行登陆，可以使用密码加验证码的方式登陆

